# STARK Math: The Journey Begins

StarkWare 的使命是将 STARKs 带入现实世界。这是解释 STARKs 背后的理论和我们对它的实现的系列文章中的第一篇。我们将从浅入深，在随后的文章中逐步增加数学内容。

# Into

Computational Integrity (CI) 计算完整性是商业的基本属性。简单地说，它意味着某个计算的输出是正确的。 `CI` 让我们可以相信向我们展示的账户余额或商店账单。这篇文章将深入探讨无许可区块链如何在不需要信任的情况下实现 CI、它们在可扩展性和隐私方面为此付出的巨大代价，以及 STARK 如何扭转局面。

# Trust vs. Verification

## “旧世界”：**Trust, or Delegated Accountability**

金融系统（银行、经纪人、交易所等）需要诚信经营，以发挥其社会功能。什么机制能激励它们诚信经营？旧世界 "假定信任代表诚信。我们相信银行、养老基金等会诚信经营。让我们走入兔子洞，研究一下这种信任的基础，而不要理会 "诚信剧院"--高楼大厦和华丽的西装--给我们留下的印象。从纯粹理性和功利的角度来看，阻止金融体系没收我们所有资金的是社会耻辱、牢狱之灾和罚款的威胁。此外，还有一个胡萝卜--声誉，它可以吸引未来的客户，创造未来的利润。通过在财务报表上签名，"旧世界 "的人们将自己的人身自由、现有和未来的财务作为诚信的抵押，而我们，公众，则将我们的信任建立在这种安排之上。这种诚信的验证工作委托给了会计师、审计师和监管机构等专家。我们称之为 "授权问责"。这并不是一个糟糕的制度：它已经忠实地为现代经济服务了相当长的时间

可信执行环境（TEE）是 "旧世界 "方法的一个新变种。受信任的硬件制造商（如英特尔）生产的物理机器（如 SGX 芯片）不能偏离指定的计算，并使用只有该物理机器知道的秘钥签署正确的状态。现在，完整性基于对硬件及其制造商的信任，以及不可能从此类物理设备中提取秘钥的假设。

## “新世界”：**Verify, or Inclusive Accountability**

区块链为实现诚信提供了一种更直接的方式，其座右铭是 "不要信任，要验证"。这个 "新世界 "不需要诚信剧院，不依赖会计师，其开发者和网络维护者也不需要以个人自由为代价来赢得公众信任。完整性由 "包容性责任"（Inclusive Accountability）来保证：一个拥有标准计算设置（一台连接网络的笔记本电脑）的节点应该能够验证系统中所有交易的完整性。

在无权限区块链中，验证 CI 的普遍方法是天真重放：要求所有节点重新执行（重放）验证每笔交易的计算。这种天真形式的包容性问责制会带来两个直接挑战：

- **Privacy：**如果每个人都能检查所有交易，那么隐私就可能受到损害。隐私的缺失会使企业望而却步，因为这意味着敏感信息可能无法保持专有性。它也会对个人造成威慑，因为它侵蚀了人的尊严。
- **Scalability：**要求系统对标准笔记本电脑负责，就意味着不能通过简单地移动到更大的电脑和更大的带宽来扩展系统。这导致系统的吞吐量受到严重限制。
- 

证明系统（接下来将讨论）是解决这两个难题的绝佳方案。现在，零知识（ZK）证明系统已经成为解决区块链隐私问题的成熟工具，Zcash 的多篇文章[1, 2, 3]对此进行了出色的解释。虽然 ZK-STARK 提供零知识证明，但这篇文章将不讨论它，而是重点讨论可扩展性和透明度（STARK 中的 S 和 T）。

# **Proof Systems**

证明系统始于 Goldwasser、Micali 和 Rackoff 于 1985 年推出的[交互式证明](https://en.wikipedia.org/wiki/Interactive_proof_system) (IP) 模型。交互式证明是涉及两种实体的协议：证明者和验证者，他们通过发送信息在若干轮中进行交互。证明者和验证者的目标相互冲突：证明者想让验证者相信某个计算的完整性，而验证者是公众委托的可疑守门人(gatekeeper)，其任务是区分真假。证明者和验证者进行交互式交流，轮流向对方发送信息。这些信息取决于被证明的语句和之前的信息，也可能使用一些随机性。在证明者一方，随机性被用来实现零知识，而在验证者一方，随机性需要用来生成对证明者的查询。在互动过程结束时，验证器会输出一个决定，要么接受新状态，要么拒绝新状态。

一个很好的比喻(analogy )是，当一方当事人提交索赔要求，而另一方当事人质疑其有效性时，法院会进行审查。要使权利要求被视为真实，权利要求者（证明者）对审查者（验证者）的询问所提供的答案必须是一致和有效的。审查过程有望揭露陈述与现实之间的任何不匹配之处，从而揭露其虚假性。 

如果将系统从状态 A 更新到状态 B 时，以下属性成立，我们就说证明系统解决了 CI 问题：

- **Completeness（完整性）：如果证明者确实知道如何以有效的方式将状态从 A 变为 B，那么证明者就能说服验证者接受这种变化。**
- **Soundness（健壮性）：如果验证者不知道如何将状态从 A 变为 B，那么验证者就会注意到交互中的不一致，并拒绝接受所建议的状态转换。但仍有极小的假阳性概率，即验证者接受无效证明的概率。该概率是一个系统安全参数，可设置为可接受的水平，如 1/(2¹²⁸)，类似于连续赢五次强力球的概率。**

这一对属性对前面讨论的 "包容性问责 （Inclusive Accountability）"原则有着至关重要的影响。验证者可以接受证明者建议的状态转换，而无需对证明者的完整性做出任何假设。事实上，prover可以在有问题的硬件上运行，可以是闭源的，也可以在由恶意实体控制的计算机上执行。事实上，验证器可以在有问题的硬件上运行，可以是闭源的，也可以在由恶意实体控制的计算机上执行。

zkslr：总结就是说通过zkp，prover发送的prove只要被verifier接受，我们就认为CI成立。

# **STARK**

现在，证明系统的理论构造和实现方法已经相当多了。有些部署在加密货币中，如 [Zerocash/Zcash](https://z.cash/) 使用的 [SNARKs](https://z.cash/learn/what-are-zk-snarks/) 和 [Monero](https://www.getmonero.org/) 部署的 [Bulletproofs](https://eprint.iacr.org/2017/1066) (BP)。（[zkp通用课程课件等](https://zkp.science/)）。[STARK](https://eprint.iacr.org/2018/046) 的与众不同之处在于它结合了以下三个特性：可扩展性scalability （STARK 中的 S）、透明度transparency （STARK 中的 T）和精益加密lean cryptography。

## **Scalability — Exponential Speedup of Verification**

可扩展性 ——指数级验证速度

可扩展性意味着两种效率特性同时存在：

- **Scalable Prover：证明者的运行时间是“接近线性(nearly-linear)”的，即受信任的计算机通过重新执行计算本身并检查结果是否与某人声称的相符来检查 CI 所需的时间。 “开销”的比率（生成证明所需的时间/运行计算所需的时间）仍然相当低。**
- **Scalable Verifier：验证者的运行时间是 `朴素重放`时间对数的多项式。 换句话说，验证者的运行时间比简单地重放计算要小得多（回想一下，“重放”是当前实现包容性问责的区块链方法）。**

![Untitled](STARK%20Math%20The%20Journey%20Begins%205c64321f13c7433c8bf846eb3138dbb5/Untitled.png)

将这一可扩展性概念应用于区块链。试想一下，当区块链转向使用证明系统进行验证时，情况会是怎样，而不是目前这种通过重放进行验证的模式。Prover 节点不需要简单地发送要添加到区块链中的交易，而是需要生成一个证明，但由于采用了Scalable Prover ，其运行时间几乎与重放解决方案的运行时间成线性关系。 `Scalable Verifier` 将受益于验证时间的指数减少。 此外，随着区块链吞吐量的扩大，大部分影响将由证明者节点（可以在专用硬件上运行，如矿工）承担，而构成网络中大部分节点的验证者几乎不会受到影响 。

让我们考虑一个具体的假设示例，假设验证者时间（以毫秒为单位）像交易数量 (tx) 对数的平方一样缩放。 假设我们从每个区块 10,000 笔交易开始。 那么验证者的运行时间为

VTime *= (*log₂ *10,000)² ~ (13.2)² ~ 177 ms*

现在将块大小增加一百倍（达到 1,000,000 tx/块）。verifier 新的运行时间为

VTime *= (*log₂ *1,000,000)² ~ 20² ~ 400 ms*

换句话说，交易吞吐量增加 100 倍，验证者的运行时间却只增加了 2.25 倍！

在某些情况下，验证者仍然需要下载并验证数据的可用性，这是一个线性时间过程，但下载数据通常比检查其有效性更便宜且更快。

## **Transparency: with Trust toward None, with Integrity for All**

透明度意味着没有可信的设置——在系统的设置过程中不使用秘密。 透明度有很多好处。 它消除了构成单点故障的参数设置生成过程。 由于缺乏可信的设置，即使是强大的实体——控制“旧世界”金融体系的大公司、垄断企业和政府——也能证明 CI 并获得公众对其主张的接受，因为没有已知的方法可以伪造 STARK 的虚假证明， 即使是最强大的实体。 在更具战术性的层面上，它使得部署新工具和基础设施以及更改现有工具和基础设施变得更加容易，而无需复杂的参数生成仪式。 最重要的是，透明度与“新世界”非常契合，“新世界”要求在不信任的假设下实行包容性问责制。 用亚伯拉罕·林肯的话来说，透明的系统允许对任何人都信任，对所有人都诚信。

## **Lean Cryptography: Secure & Fast**

STARK 的安全性基于最基本的加密假设：存在安全的加密和抗碰撞哈希函数。如今，这些基元中有许多已作为硬件指令存在，而精简的加密技术还能带来另外两个好处：

- **Post-Quantum Security：面对高效量子计算机，STARKs 的安全性是可信的。**
- **Concrete Efficiency：对于给定的计算，STARK prover 比 SNARK 和 Bulletproofs prover 都至少快 10 倍。STARKverifier 比 SNARK verifier 至少快 2 倍，比 Bulletproof verifier 快 10 倍以上。随着 StarkWare 不断优化 STARK，这些比率很可能会提高。不过，STARK 的证明长度比相应的 SNARK 长 100 倍，比 BulletProofs 长 20 倍。**

# 总结

我们首先解释无需许可的区块链的“新世界”，其中的座右铭是“不要信任，验证”。 包容性问责原则要求任何人都可以轻松验证金融体系的完整性，这与“旧世界”的委托问责不同。 为了使区块链能够扩展，我们需要能够比简单重放更快地验证计算完整性的方法。

STARK 是一种特殊的证明系统，具有可扩展性和透明度，并且基于精益密码学。 它们的可扩展性和透明度允许对 CI 进行廉价且无需信任的验证。 这是 STARKs 的承诺，也是 StarkWare 的使命。

我们的下一篇文章将更深入地探讨构建 STARK 的数学原理。

感谢 Vitalik Buterin 和 Arthur Breitman 审阅本博客文章的草稿。